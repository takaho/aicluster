aiCluster
====
  Machine learning-based subgroup prediction system running as a standalone GUI application, command line program and a web service.

## Description
  The program apply random forest algorithm to cluster given data in tab-deliminated text, CSV and Excel (.xls and .xlsx) format.
  Predicted results are shown with the outputs of decision trees.

## Requirement

This application depends on following Python (>=2.7 or >3.0) packages.
- wxPython (for GUI users)
- sklearn (scikit-learn)
- numpy
- scipy
- pillow (alternative package of Python Imaging Library, version >= 2.6)
- xlrd (to read Excel .xls files)
- openpyxl (to read Excel .xlsx files)

Web server requires Javascript environment.
- Node.js
- express
In addition SQLite3 should be installed to manage database and intall it if your environment does not have it.

## Install
To install additional packages for web server, run the following command before starting up the service.

    npm install

The server starts with following command.

    node aicserver

The default port of the server is 8091 and you can access the page at the URL http://localhost:8091/. The URL of local host is open when the program starts without --server option.

## Uninstall
Since all resources are included in the aicluster directory, the application is removed if contents in the directory are deleted.

## Usage

Command line version can be used as following options

    rfprediction.py [-h] [-i filename] [-t filename] [-o directory]
                       [-n number] [-d number] [-F field name] [-I field name]
                       [--best filename] [--verbose] [--without-rawdata]
                       [--iteration ITERATION] [--key characters]
                       [--model json file]

### Options

    -h, --help            show this help message and exit
    -i filename           input CSV file
    -t filename           training data
    -o directory          output directory (default out)
    -n number             number of trees
    -d number             maximum depth of decision tree
    -F field name         output column
    -I field name         identifier column
    --best filename       output best tree (PDF)
    --verbose             verbosity
    --without-rawdata     remove rawdata from report
    --iteration ITERATION
                        the number of iteration to estimate weights of
                        parameters
    --key characters      unique ID
    --model json file     JSON filename of model

If you construct prediction trees with given data, use -t option.
  Prediction mode is available if you use '--model' option with JSON file generated by this script run with -t option.
  -o option specifies output directory having an HTML document, images and a file containing JSON object. The JSON file can be reused to predict other data. If you require only JSON object, set a filename 'xxxx.json' for -o option.

Web server starts with Express framework with Node.js.

    node aicserver [--port port_number] [--db database_path] [--server] [--verbose]

### Options
    --port                port number of service (default 8091)
    --db                  SQLite database path (default db/datastore.db)
    --server              Run without opening browser
    --verbose             verbosity

This command automatically opens top page of the service. You can use the local server with the browser.

The python scripts are also available as a stand-alone application.
  If wxPython is installed, the following command open the main window to process the data.

    python ADGroup.py


### Docker

You can this docker containers this following commands:

#### Miniconda

```
cd docker/miniconda/
./build.sh
./run.sh
```

#### aiCluster

```
cd docker/miniconda/
./build.sh
./run.sh
```

Please view http://localhost:8091 in your browser.

## Licence

[MIT](https://github.com/tcnksm/tool/blob/master/LICENCE)

## Author
All codes were written by Takaho A. Endo and Koichi Ashizaki, RIKEN IMS-RCAI
